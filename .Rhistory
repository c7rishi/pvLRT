signal_mat
sim_statin <- r_contin_table_zip(
n = 1,
row_marginals = rowSums(statin46),
col_marginals = colSums(statin46),
signal_mat = signal_mat,
omega_vec = omega_tru,
no_zero_inflation_idx = list(
c(1, 1),
c(2, 1),
c(nrow(statin46), 0), # the entire last row
c(0, ncol(statin46)) # the entire last column
)
)
# \dontrun{
# now analyze the above simulated data
test1 <- lrt_zi_poisson(
contin_table = sim_statin,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
attr(test1, "omega") %>% round(3)
which(test1 < 0.05, arr.ind = TRUE)
test2 <- lrt_zi_poisson(
contin_table = sim_statin,
use_gamma_smooth_omega = TRUE,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
attr(test2, "omega") %>% round(3)
which(test2 < 0.05, arr.ind = TRUE)
test3 <- lrt_zi_poisson(
contin_table = sim_statin,
omega_est_vec = omega_tru,
)
attr(test3, "omega") %>% round(2)
which(test3 < 0.05, arr.ind = TRUE)
# }
# "positive" signal at the first two elements of the
# the first column
signal_mat[1, 1] <- signal_mat[2, 1] <- 100
sim_statin <- r_contin_table_zip(
n = 1,
row_marginals = rowSums(statin46),
col_marginals = colSums(statin46),
signal_mat = signal_mat,
omega_vec = omega_tru,
no_zero_inflation_idx = list(
c(1, 1),
c(2, 1),
c(nrow(statin46), 0), # the entire last row
c(0, ncol(statin46)) # the entire last column
)
)
# \dontrun{
# now analyze the above simulated data
test1 <- lrt_zi_poisson(
contin_table = sim_statin,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
attr(test1, "omega") %>% round(3)
which(test1 < 0.05, arr.ind = TRUE)
# "positive" signal at the first two elements of the
# the first column
signal_mat[1, 1] <- signal_mat[2, 1] <- 25
# Now simulate data with the same row/column marginals
# as in statin46, with embedded signals as specified in
# the above signal_mat
# no zero inflation at (1, 1) and (2, 1)
# (where signal is elicited) and the last row ("Other PT")
# and at the last column ("Other drugs") of the simulated matrix
sim_statin <- r_contin_table_zip(
n = 1,
row_marginals = rowSums(statin46),
col_marginals = colSums(statin46),
signal_mat = signal_mat,
omega_vec = omega_tru,
no_zero_inflation_idx = list(
c(1, 1),
c(2, 1),
c(nrow(statin46), 0), # the entire last row
c(0, ncol(statin46)) # the entire last column
)
)
# \dontrun{
# now analyze the above simulated data
test1 <- lrt_zi_poisson(
contin_table = sim_statin,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
attr(test1, "omega") %>% round(3)
which(test1 < 0.05, arr.ind = TRUE)
test2 <- lrt_zi_poisson(
contin_table = sim_statin,
use_gamma_smooth_omega = TRUE,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
attr(test2, "omega") %>% round(3)
which(test2 < 0.05, arr.ind = TRUE)
test3 <- lrt_zi_poisson(
contin_table = sim_statin,
omega_est_vec = omega_tru,
)
attr(test3, "omega") %>% round(2)
which(test3 < 0.05, arr.ind = TRUE)
# }
# zero inflation probabilities
omega_tru <- c(rep(0.1, ncol(statin46)-1), 0)
# signal matrix
signal_mat <- matrix(1, nrow(statin46), ncol(statin46))
# "positive" signal at the first two elements of the
# the first column
signal_mat[1, 1] <- signal_mat[2, 1] <- 25
sim_statin <- r_contin_table_zip(
n = 1,
row_marginals = rowSums(statin46),
col_marginals = colSums(statin46),
signal_mat = signal_mat,
omega_vec = omega_tru,
no_zero_inflation_idx = list(
c(1, 1),
c(2, 1),
c(nrow(statin46), 0), # the entire last row
c(0, ncol(statin46)) # the entire last column
)
)
# \dontrun{
# now analyze the above simulated data
test1 <- lrt_zi_poisson(
contin_table = sim_statin,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
attr(test1, "omega") %>% round(3)
which(test1 < 0.05, arr.ind = TRUE)
rm(list=ls())
set.seed(42)
# first load the 46 statin data
data(statin46)
# zero inflation probabilities
omega_tru <- c(rep(0.1, ncol(statin46)-1), 0)
# signal matrix
signal_mat <- matrix(1, nrow(statin46), ncol(statin46))
# "positive" signal at the first two elements of the
# the first column
signal_mat[1, 1] <- signal_mat[2, 1] <- 25
sim_statin <- r_contin_table_zip(
n = 1,
row_marginals = rowSums(statin46),
col_marginals = colSums(statin46),
signal_mat = signal_mat,
omega_vec = omega_tru,
no_zero_inflation_idx = list(
c(1, 1),
c(2, 1),
c(nrow(statin46), 0), # the entire last row
c(0, ncol(statin46)) # the entire last column
)
)
test1 <- lrt_zi_poisson(
contin_table = sim_statin,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
library(pvLRT)
set.seed(42)
# first load the 46 statin data
data(statin46)
# zero inflation probabilities
omega_tru <- c(rep(0.1, ncol(statin46)-1), 0)
# signal matrix
signal_mat <- matrix(1, nrow(statin46), ncol(statin46))
# "positive" signal at the first two elements of the
# the first column
signal_mat[1, 1] <- signal_mat[2, 1] <- 25
sim_statin <- r_contin_table_zip(
n = 1,
row_marginals = rowSums(statin46),
col_marginals = colSums(statin46),
signal_mat = signal_mat,
omega_vec = omega_tru,
no_zero_inflation_idx = list(
c(1, 1),
c(2, 1),
c(nrow(statin46), 0), # the entire last row
c(0, ncol(statin46)) # the entire last column
)
)
library(pvLRT)
set.seed(42)
# first load the 46 statin data
data(statin46)
# zero inflation probabilities
omega_tru <- c(rep(0.1, ncol(statin46)-1), 0)
# signal matrix
signal_mat <- matrix(1, nrow(statin46), ncol(statin46))
# "positive" signal at the first two elements of the
# the first column
signal_mat[1, 1] <- signal_mat[2, 1] <- 25
sim_statin <- r_contin_table_zip(
n = 1,
row_marginals = rowSums(statin46),
col_marginals = colSums(statin46),
signal_mat = signal_mat,
omega_vec = omega_tru,
no_zero_inflation_idx = list(
c(1, 1),
c(2, 1),
c(nrow(statin46), 0), # the entire last row
c(0, ncol(statin46)) # the entire last column
)
)
test1 <- lrt_zi_poisson(
contin_table = sim_statin,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
attr(test1, "omega") %>% round(3)
which(test1 < 0.05, arr.ind = TRUE)
rm(list=ls())
set.seed(42)
# first load the 46 statin data
data(statin46)
# zero inflation probabilities
omega_tru <- c(rep(0.1, ncol(statin46)-1), 0)
# signal matrix
signal_mat <- matrix(1, nrow(statin46), ncol(statin46))
# "positive" signal at the first two elements of the
# the first column
signal_mat[1, 1] <- signal_mat[2, 1] <- 25
# "positive" signal at the first two elements of the
# the first column
signal_mat[1, 1] <- signal_mat[2, 1] <- 25
sim_statin <- r_contin_table_zip(
n = 1,
row_marginals = rowSums(statin46),
col_marginals = colSums(statin46),
signal_mat = signal_mat,
omega_vec = omega_tru,
no_zero_inflation_idx = list(
c(1, 1),
c(2, 1),
c(nrow(statin46), 0), # the entire last row
c(0, ncol(statin46)) # the entire last column
)
)
test1 <- lrt_zi_poisson(
contin_table = sim_statin,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
attr(test1, "omega") %>% round(3)
which(test1 < 0.05, arr.ind = TRUE)
test2 <- lrt_zi_poisson(
contin_table = sim_statin,
use_gamma_smooth_omega = TRUE,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
attr(test2, "omega") %>% round(3)
which(test2 < 0.05, arr.ind = TRUE)
test3 <- lrt_zi_poisson(
contin_table = sim_statin,
omega_est_vec = omega_tru,
)
attr(test3, "omega") %>% round(2)
which(test3 < 0.05, arr.ind = TRUE)
rowSums(statin46)
rowSums(statin46) %>% length()
# "positive" signal at the first two elements of the
# the first column
signal_mat[1, 1] <- signal_mat[45, 1] <- 25
sim_statin <- r_contin_table_zip(
n = 1,
row_marginals = rowSums(statin46),
col_marginals = colSums(statin46),
signal_mat = signal_mat,
omega_vec = omega_tru,
no_zero_inflation_idx = list(
c(1, 1),
c(2, 1),
c(nrow(statin46), 0), # the entire last row
c(0, ncol(statin46)) # the entire last column
)
)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
library(pvLRT)
source('~/.active-rstudio-document', echo=TRUE)
set.seed(42)
# first load the 46 statin data
data(statin46)
# zero inflation probabilities
omega_tru <- c(rep(0.1, ncol(statin46)-1), 0)
# signal matrix
signal_mat <- matrix(1, nrow(statin46), ncol(statin46))
# "positive" signal at the 45th element (rhabdo) of the
# the first column
signal_mat[45, 1] <- 10
# Now simulate data with the same row/column marginals
# as in statin46, with embedded signals as specified in
# the above signal_mat
# no zero inflation at (1, 1) and (2, 1)
# (where signal is elicited) and the last row ("Other PT")
# and at the last column ("Other drugs") of the simulated matrix
sim_statin <- r_contin_table_zip(
n = 1,
row_marginals = rowSums(statin46),
col_marginals = colSums(statin46),
signal_mat = signal_mat,
omega_vec = omega_tru,
no_zero_inflation_idx = list(
c(45, 1),
c(nrow(statin46), 0), # the entire last row
c(0, ncol(statin46)) # the entire last column
)
)
# \dontrun{
# now analyze the above simulated data
test1 <- lrt_zi_poisson(
contin_table = sim_statin,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
attr(test1, "omega") %>% round(3)
which(test1 < 0.05, arr.ind = TRUE)
test2 <- lrt_zi_poisson(
contin_table = sim_statin,
use_gamma_smooth_omega = TRUE,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
attr(test2, "omega") %>% round(3)
which(test2 < 0.05, arr.ind = TRUE)
# true omega supplied
test3 <- lrt_zi_poisson(
contin_table = sim_statin,
omega_est_vec = omega_tru,
)
attr(test3, "omega") %>% round(2)
which(test3 < 0.05, arr.ind = TRUE)
# }
rownames(sim_statin) %>% .[45]
library(pvLRT)
set.seed(42)
# first load the 46 statin data
data(statin46)
# zero inflation probabilities
omega_tru <- c(rep(0.1, ncol(statin46)-1), 0)
# signal matrix
signal_mat <- matrix(1, nrow(statin46), ncol(statin46))
# "positive" signal at the 45th element (rhabdo) of the
# the first column
signal_mat[45, 1] <- 10
# Now simulate data with the same row/column marginals
# as in statin46, with embedded signals as specified in
# the above signal_mat
# no zero inflation at (1, 1) and (2, 1)
# (where signal is elicited) and the last row ("Other PT")
# and at the last column ("Other drugs") of the simulated matrix
sim_statin <- r_contin_table_zip(
n = 1,
row_marginals = rowSums(statin46),
col_marginals = colSums(statin46),
signal_mat = signal_mat,
omega_vec = omega_tru,
no_zero_inflation_idx = list(
c(45, 1),
c(nrow(statin46), 0), # the entire last row
c(0, ncol(statin46)) # the entire last column
)
)
# \dontrun{
# now analyze the above simulated data
test1 <- lrt_zi_poisson(
contin_table = sim_statin,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
attr(test1, "omega") %>% round(3)
which(test1 < 0.05, arr.ind = TRUE)
test2 <- lrt_zi_poisson(
contin_table = sim_statin,
use_gamma_smooth_omega = TRUE,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
attr(test2, "omega") %>% round(3)
which(test2 < 0.05, arr.ind = TRUE)
# true omega supplied
test3 <- lrt_zi_poisson(
contin_table = sim_statin,
omega_est_vec = omega_tru,
)
attr(test3, "omega") %>% round(2)
which(test3 < 0.05, arr.ind = TRUE)
# }
set.seed(42)
# first load the 46 statin data
data(statin46)
# zero inflation probabilities
omega_tru <- c(rep(0.1, ncol(statin46)-1), 0)
# signal matrix
signal_mat <- matrix(1, nrow(statin46), ncol(statin46))
# "positive" signal at the 45th element (rhabdo) of the
# the first column
signal_mat[1, 1] <- 10
# Now simulate data with the same row/column marginals
# as in statin46, with embedded signals as specified in
# the above signal_mat
# no zero inflation at (1, 1) and (2, 1)
# (where signal is elicited) and the last row ("Other PT")
# and at the last column ("Other drugs") of the simulated matrix
sim_statin <- r_contin_table_zip(
n = 1,
row_marginals = rowSums(statin46),
col_marginals = colSums(statin46),
signal_mat = signal_mat,
omega_vec = omega_tru,
no_zero_inflation_idx = list(
c(45, 1),
c(nrow(statin46), 0), # the entire last row
c(0, ncol(statin46)) # the entire last column
)
)
# \dontrun{
# now analyze the above simulated data
test1 <- lrt_zi_poisson(
contin_table = sim_statin,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
attr(test1, "omega") %>% round(3)
which(test1 < 0.05, arr.ind = TRUE)
test2 <- lrt_zi_poisson(
contin_table = sim_statin,
use_gamma_smooth_omega = TRUE,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
attr(test2, "omega") %>% round(3)
which(test2 < 0.05, arr.ind = TRUE)
# true omega supplied
test3 <- lrt_zi_poisson(
contin_table = sim_statin,
omega_est_vec = omega_tru,
)
attr(test3, "omega") %>% round(2)
which(test3 < 0.05, arr.ind = TRUE)
# }
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
set.seed(42)
# first load the 46 statin data
data(statin46)
# zero inflation probabilities
omega_tru <- c(rep(0.15, ncol(statin46)-1), 0)
# signal matrix
signal_mat <- matrix(1, nrow(statin46), ncol(statin46))
# "positive" signal at the (1, 1) entry
# the first column
signal_mat[1, 1] <- 10
# Now simulate data with the same row/column marginals
# as in statin46, with embedded signals as specified in
# the above signal_mat
# no zero inflation at (1, 1) and (2, 1)
# (where signal is elicited) and the last row ("Other PT")
# and at the last column ("Other drugs") of the simulated matrix
sim_statin <- r_contin_table_zip(
n = 1,
row_marginals = rowSums(statin46),
col_marginals = colSums(statin46),
signal_mat = signal_mat,
omega_vec = omega_tru,
no_zero_inflation_idx = list(
c(45, 1),
c(nrow(statin46), 0), # the entire last row
c(0, ncol(statin46)) # the entire last column
)
)
# \dontrun{
# now analyze the above simulated data
test1 <- lrt_zi_poisson(
contin_table = sim_statin,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
attr(test1, "omega") %>% round(3)
which(test1 < 0.05, arr.ind = TRUE)
test2 <- lrt_zi_poisson(
contin_table = sim_statin,
use_gamma_smooth_omega = TRUE,
skip_null_omega_estimation = TRUE
# set to TRUE for speed, should be FALSE in the final analysis
)
attr(test2, "omega") %>% round(3)
which(test2 < 0.05, arr.ind = TRUE)
# true omega supplied
test3 <- lrt_zi_poisson(
contin_table = sim_statin,
omega_est_vec = omega_tru,
)
attr(test3, "omega") %>% round(2)
which(test3 < 0.05, arr.ind = TRUE)
# }
?r_contin_table_zip
gc()
